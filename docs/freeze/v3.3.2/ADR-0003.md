---
> âš ï¸ COPIE FREEZE â€” NE PAS MODIFIER CE FICHIER
> Source canonique : docs/adrs/ADR-0003.md
> Freeze tag       : v3.3.2-freeze-patch3
> Date freeze      : 2026-02-16
> Toute modification doit passer par ADR numÃ©rotÃ© + validation CTO
---

# ADR-0003 â€” Plan d'ExÃ©cution CTO Grade V3.3.2
## Document de gel â€” Opposable aux agents humains et IA

```
Status       : ACCEPTED â€” Ã€ GELER
Date         : 2026-02-16
Author       : Abdoulaye Ousmane (Founder & CTO)
Constitution : V3.3.2 (canonique, frozen)
PrÃ©cÃ©dents   : ADR-0001 (fusion M10-UX + M-SECURITY-CORE)
               ADR-0002 (bÃ©tonisation CI + dictionnaire Sahel)
Objet        : Geler le plan d'exÃ©cution CTO Grade comme
               rÃ©fÃ©rence opposable Ã  tout agent (humain ou IA)
               avant le premier commit de code mÃ©tier
Fichier      : docs/adrs/ADR-0003.md
Freeze tag   : v3.3.2-freeze-patch3
```

---

## 0. Pourquoi ce gel est nÃ©cessaire

```
DIAGNOSTIC

Sans ce gel, les risques immÃ©diats sont :

  R-1 : Un agent IA commence Ã  coder M-DOCS-CORE
        sans avoir crÃ©Ã© la Phase ZÃ©ro â†’ repo instable

  R-2 : L'ordre interne d'un milestone est inversÃ©
        (endpoint avant migration â†’ CI rouge non explicable)

  R-3 : Les triggers PostgreSQL sont Ã©crits dans le code
        Python au lieu d'Ãªtre dans la migration SQL
        â†’ INV-6 contournable

  R-4 : Le dictionnaire Sahel est "complÃ©tÃ© plus tard"
        â†’ moat inexistant au premier test terrain

  R-5 : Un deuxiÃ¨me agent travaille sur un milestone
        diffÃ©rent en parallÃ¨le â†’ conflits + dÃ©pendances
        non respectÃ©es

Ce gel ferme ces 5 risques avant le premier commit.
```

---

## 1. PÃ©rimÃ¨tre du gel

Ce document gÃ¨le **trois artefacts** produits lors de la session
de cadrage CTO du 2026-02-16 :

| Artefact | Statut | RÃ©fÃ©rence |
|----------|--------|-----------|
| Plan d'exÃ©cution CTO Grade | GELÃ‰ | Â§2 ci-dessous |
| RÃ¨gles de travail agent | GELÃ‰ES | Â§3 ci-dessous |
| Gates GO/NO-GO | GELÃ‰ES | Â§4 ci-dessous |

---

## 2. Plan d'exÃ©cution gelÃ©

### 2.1 â€” Principe de commandement (opposable)

```
LOI D'EXÃ‰CUTION â€” NON NÃ‰GOCIABLE

  Un milestone = Un sprint = Une branche = Une PR = Un merge.

  Jamais :
    âŒ Deux milestones en parallÃ¨le
    âŒ PR mergÃ©e avec CI rouge
    âŒ Tests Ã©crits aprÃ¨s le code
    âŒ Trigger PostgreSQL Ã©crit en Python (doit Ãªtre en SQL/migration)
    âŒ Dictionnaire "complÃ©tÃ© plus tard"
    âŒ Milestone marquÃ© .done sans CI verte

  Toujours :
    âœ… Definition of Done binaire (DONE ou ABSENT)
    âœ… Migration SQL AVANT le service Python
    âœ… Trigger DB AVANT l'endpoint qui s'appuie dessus
    âœ… Test DB-level AVANT le test API
    âœ… Squelette test activÃ© AVANT le code qu'il teste
```

### 2.2 â€” Ordre d'exÃ©cution interne Ã  chaque milestone (opposable)

```
SÃ‰QUENCE INTERNE OBLIGATOIRE (tout milestone)

  Ã‰TAPE 1 : Migration Alembic (SQL explicite, pas d'ORM)
            â†’ inclut les triggers PostgreSQL si applicable
  Ã‰TAPE 2 : Tests DB-level (tests/db_integrity/ ou phase0/)
            â†’ verts avant de passer Ã  l'Ã©tape suivante
  Ã‰TAPE 3 : Service Python (CRUD, logique mÃ©tier)
            â†’ requÃªtes paramÃ©trÃ©es exclusivement
  Ã‰TAPE 4 : Endpoints FastAPI
  Ã‰TAPE 5 : Tests API (httpx / TestClient)
  Ã‰TAPE 6 : make test â†’ CI verte locale
  Ã‰TAPE 7 : make milestone-done M=<ID>
  Ã‰TAPE 8 : PR â†’ CI GitHub verte â†’ merge main

  INTERDICTION : passer Ã  l'Ã©tape N+1 si l'Ã©tape N est rouge.
```

### 2.3 â€” SÃ©quence des phases (opposable)

```
PHASE ZÃ‰RO â€” Socle repo (AVANT TOUT MILESTONE)
  Livrable 0.1 : Structure dossiers (src/, tests/, alembic/, docs/)
  Livrable 0.2 : requirements.txt figÃ© (versions exactes)
  Livrable 0.3 : src/db/connection.py (helper psycopg2 synchrone)
  Livrable 0.4 : Makefile (commandes canoniques)
  Livrable 0.5 : tests/conftest.py (fixture db_conn psycopg2 raw)
  Livrable 0.6 : alembic/env.py configurÃ©
  Gate         : make test â†’ tous skipped (0 Ã©chec)
                 CI verte sur main
  â†’ SEULEMENT ALORS : dÃ©marrer M-DOCS-CORE

PHASE 0 â€” Milestones fondations
  M-DOCS-CORE              (2-3 jours)
  M-EXTRACTION-ENGINE      (3-4 jours)
  M-EXTRACTION-CORRECTIONS (2 jours)

PHASE 1 â€” Normalisation & critÃ¨res
  M-CRITERIA-TYPING        (2 jours)
  M-NORMALISATION-ITEMS    (5-7 jours) â† MILESTONE CRITIQUE

PHASE 2 â€” Scoring & comitÃ©
  M-SCORING-ENGINE         (3-4 jours) â† Active test AST frontiÃ¨re A/B
  M-SCORING-TESTS-CRITIQUES(2 jours)
  M-COMMITTEE-CORE         (3 jours)   â† LOCK irrÃ©versible DB-level

PHASE 3 â€” GÃ©nÃ©ration & pipeline
  M-CBA-TEMPLATES          (1 jour)
  M-PV-TEMPLATES           (1 jour)
  M-CBA-GEN                (2 jours)
  M-PV-GEN                 (2 jours)
  M-PIPELINE-A-E2E         (2-3 jours)

PHASE 4 â€” SÃ©curitÃ© & traÃ§abilitÃ©
  M-SECURITY-CORE          (3 jours)
  M-TRACE-HISTORY          (2 jours)
  M-CI-INVARIANTS          (1 jour)

PHASE 5 â€” Couche B & Market Signal
  M-MARKET-DATA-TABLES     (2 jours)
  M-MARKET-INGEST          (2 jours)
  M-MARKET-SURVEY-WORKFLOW (3 jours)
  M-MARKET-SIGNAL-ENGINE   (3-4 jours)
  M-CONTEXT-UI-PANEL       (2 jours)
  M-DICT-FUZZY-MATCH       (2 jours)

PHASE 6 â€” DevOps
  M-MONITORING-OPS         (2 jours)
  M-DEVOPS-DEPLOY          (2 jours)

PHASE 7 â€” Produit & terrain
  M10-UX-V2                (5-7 jours)
  M-UX-TEST-TERRAIN        (3 jours)
  M-ERP-AGNOSTIC-CHECK     (1 jour)
  M-PILOT-EARLY-ADOPTERS   (ongoing)
```

### 2.4 â€” DurÃ©es estimÃ©es par milestone (gelÃ©es)

```
DURÃ‰ES OPPOSABLES (estimations CTO â€” non nÃ©gociables Ã  la baisse)

  Phase ZÃ©ro               : 1 jour
  M-DOCS-CORE              : 2-3 jours
  M-EXTRACTION-ENGINE      : 3-4 jours
  M-EXTRACTION-CORRECTIONS : 2 jours
  M-CRITERIA-TYPING        : 2 jours
  M-NORMALISATION-ITEMS    : 5-7 jours  â† dictionnaire = donnÃ©es
  M-SCORING-ENGINE         : 3-4 jours
  M-SCORING-TESTS-CRITIQUES: 2 jours
  M-COMMITTEE-CORE         : 3 jours
  M-CBA-TEMPLATES          : 1 jour
  M-PV-TEMPLATES           : 1 jour
  M-CBA-GEN                : 2 jours
  M-PV-GEN                 : 2 jours
  M-PIPELINE-A-E2E         : 2-3 jours
  M-SECURITY-CORE          : 3 jours
  M-TRACE-HISTORY          : 2 jours
  M-CI-INVARIANTS          : 1 jour
  M-MARKET-DATA-TABLES     : 2 jours
  M-MARKET-INGEST          : 2 jours
  M-MARKET-SURVEY-WORKFLOW : 3 jours
  M-MARKET-SIGNAL-ENGINE   : 3-4 jours
  M-CONTEXT-UI-PANEL       : 2 jours
  M-DICT-FUZZY-MATCH       : 2 jours
  M-MONITORING-OPS         : 2 jours
  M-DEVOPS-DEPLOY          : 2 jours
  M10-UX-V2                : 5-7 jours
  M-UX-TEST-TERRAIN        : 3 jours
  M-ERP-AGNOSTIC-CHECK     : 1 jour
  M-PILOT-EARLY-ADOPTERS   : ongoing

  TOTAL estimÃ© (sÃ©quentiel strict) : 70-90 jours ouvrÃ©s
```

### 2.5 â€” Livrables Phase ZÃ©ro (gelÃ©s, contenu exact)

```
FICHIER                         CONTENU GELÃ‰
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
requirements.txt                Versions exactes :
                                  fastapi==0.111.0
                                  uvicorn[standard]==0.29.0
                                  python-multipart==0.0.9
                                  psycopg2-binary==2.9.9
                                  alembic==1.13.1
                                  pdfplumber==0.11.0
                                  PyMuPDF==1.24.2
                                  python-docx==1.1.0
                                  openpyxl==3.1.2
                                  pytesseract==0.3.10
                                  python-magic==0.4.27
                                  python-jose[cryptography]==3.3.0
                                  passlib[bcrypt]==1.7.4
                                  slowapi==0.1.9
                                  pydantic==2.7.0
                                  python-dotenv==1.0.1
                                  pytest==8.2.0
                                  pytest-cov==5.0.0
                                  httpx==0.27.0
                                  ruff==0.9.10
                                  black==24.3.0

src/db/connection.py            Helper psycopg2 synchrone
                                get_db_connection() context manager
                                get_db_cursor() shortcut
                                RequÃªtes paramÃ©trÃ©es UNIQUEMENT
                                Pas d'ORM, pas de f-string SQL

tests/conftest.py               Fixture db_conn (scope=session)
                                Fixture db_transaction (rollback)
                                Fixture test_client (FastAPI)

Makefile                        Cibles : install, migrate,
                                test, test-db, test-invariants,
                                test-cov, test-fast, lint, format,
                                check-all, milestone-done,
                                milestone-status

alembic/env.py                  DATABASE_URL depuis os.environ
                                include_schemas=True
                                compare_type=True
```

---

## 3. RÃ¨gles de travail agent (gelÃ©es, opposables)

### 3.1 â€” RÃ¨gles pour tout agent (humain ou IA)

```
RÃˆGLES AGENT â€” NIVEAU CONSTITUTIONNEL

  AVANT CHAQUE SESSION DE CODE :
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  1. Lire Constitution V3.3.2
  2. Lire ADR-0001 + ADR-0002 + ADR-0003
  3. ExÃ©cuter : make milestone-status
     â†’ identifier le milestone en cours
  4. Lire la migration du milestone en cours
  5. VÃ©rifier l'Ã©tape courante dans la sÃ©quence Â§2.2

  INTERDICTIONS ABSOLUES :
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  âŒ Importer module Couche B dans src/scoring/ src/pipeline/
     src/normalisation/ src/criteria/ src/extraction/
     src/committee/ src/generation/
     [Test CI : test_couche_a_b_boundary.py â€” bloque CI]

  âŒ RequÃªtes SQL non paramÃ©trÃ©es
     Exemple interdit : f"SELECT * FROM cases WHERE id='{id}'"
     Exemple correct  : cur.execute("SELECT * FROM cases
                        WHERE id=%s", (id,))

  âŒ ORM (SQLAlchemy, Tortoise, Beanie, etc.)

  âŒ Redis pour stocker : scores, dÃ©cisions, audit,
     corrections, committee_members
     Redis = cache non-autoritaire uniquement

  âŒ Supprimer ou modifier un trigger PostgreSQL existant
     sans ADR validÃ© CTO

  âŒ Committer directement sur main

  âŒ Ouvrir une PR sans CI verte

  âŒ Marquer milestone .done sans make test vert

  âŒ CrÃ©er ou renommer un milestone sans ADR + validation CTO

  âŒ Ã‰crire du code mÃ©tier avant Phase ZÃ©ro complÃ¨te

  OBLIGATIONS :
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  âœ… Migration SQL AVANT service Python (Â§2.2 Ã‰tape 1 avant 3)
  âœ… Trigger PostgreSQL DANS la migration (pas dans le code)
  âœ… Test DB-level AVANT test API (Â§2.2 Ã‰tape 2 avant 5)
  âœ… sha256 calculÃ© sur contenu rÃ©el (jamais sur Content-Type)
  âœ… magic bytes validÃ©s par python-magic (jamais Content-Type)
  âœ… structured_data JSONB avec tous les champs minimaux
     mÃªme si vides (doc_kind, language_detected,
     detected_tables, detected_sections,
     candidate_criteria, candidate_line_items,
     currency_detected, dates_detected,
     supplier_candidates, _low_confidence,
     _requires_human_review, _extraction_duration_ms)
  âœ… Â§9 Constitution : Ã©chec explicite toujours prÃ©fÃ©rÃ©
     au rÃ©sultat ambigu
```

### 3.2 â€” Convention de nommage (gelÃ©e)

```
BRANCHES
  Format   : feat/<ID-MILESTONE-EXACT>
  Exemples : feat/M-DOCS-CORE
             feat/M-NORMALISATION-ITEMS
             feat/M-SCORING-ENGINE
  Interdit : feat/scoring, feat/fix-db, feat/wip,
             feat/misc-improvements

MIGRATIONS ALEMBIC
  Format   : NNN_<id_milestone_snake>.py
  Exemples : 001_m_docs_core.py
             002_m_extraction_corrections.py
             005_seed_dict_procurement_sahel.py
  Interdit : migration.py, fix.py, update_db.py

FICHIERS .done
  Format   : .milestones/<ID-EXACT>.done
  Exemples : .milestones/M-DOCS-CORE.done
             .milestones/M-SCORING-ENGINE.done
  Interdit : .milestones/scoring.done
             .milestones/done_phase1.done

COMMITS
  Format   : <type>(<milestone>): <description>
  Exemples : feat(M-DOCS-CORE): migration cases + documents
             test(M-DOCS-CORE): magic bytes validation
             fix(M-EXTRACTION-ENGINE): confidence score rules
             trigger(M-COMMITTEE-CORE): lock irrÃ©versible DB-level
  Types    : feat, test, fix, trigger, migration,
             seed, docs, ci, refactor
```

### 3.3 â€” RÃ¨gles spÃ©cifiques par milestone critique

```
M-NORMALISATION-ITEMS â€” RÃˆGLES SPÃ‰CIALES
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  Le dictionnaire est seedÃ© via migration Alembic dÃ©diÃ©e.
  Jamais via script Python ad-hoc.
  Jamais via fixture de test.
  Le seed est idempotent : INSERT ... ON CONFLICT DO NOTHING.
  9 familles obligatoires avant .done :
    carburants, construction_liants, construction_agregats,
    construction_fer, vehicules, informatique,
    alimentation, medicaments, equipements
  Minimum par famille : 5 items Ã— 3 aliases.
  Test bloquant : test_dict_minimum_coverage.py
  Test bloquant : test_aliases_mandatory_sahel.py

M-SCORING-ENGINE â€” RÃˆGLES SPÃ‰CIALES
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  DÃ¨s que .milestones/M-SCORING-ENGINE.done existe,
  le test AST (test_couche_a_b_boundary.py) s'active
  automatiquement dans ci-invariants.yml.
  Le dÃ©veloppeur DOIT vÃ©rifier localement avant de crÃ©er .done :
    pytest tests/invariants/test_couche_a_b_boundary.py -v
  Si rouge â†’ le code viole Â§7 â†’ corriger avant .done.

M-COMMITTEE-CORE â€” RÃˆGLES SPÃ‰CIALES
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  Deux triggers obligatoires dans la migration :
    prevent_committee_unlock (LOCK irrÃ©versible)
    enforce_committee_lock   (membres immuables post-LOCK)
  Tests DB-level OBLIGATOIRES avant merge :
    pytest tests/db_integrity/test_lock_committee_db_level.py -v
  Si un seul test rouge â†’ PR BLOQUÃ‰E.

M-EXTRACTION-CORRECTIONS â€” RÃˆGLES SPÃ‰CIALES
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  Trigger prevent_correction_mutation dans la migration.
  Tests DB-level OBLIGATOIRES avant merge :
    pytest tests/db_integrity/test_triggers_db_level.py -v
  La vue structured_data_effective est calculÃ©e Ã  la volÃ©e.
  Jamais matÃ©rialisÃ©e en UPDATE sur extractions.structured_data.
```

---

## 4. Gates GO/NO-GO (gelÃ©s, opposables)

```
GATE 1 â€” GO ALPHA INTERNE
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  Milestones requis : M-DOCS-CORE â†’ M-PIPELINE-A-E2E (Phase 0-3)
  CI              : ğŸ”´ Tous les gates Phases 0-3 verts (19 gates)
  Coverage        : â‰¥ 60%
  SLA-A           : ProuvÃ© < 60s (test_sla_classe_a_60s.py vert)
  Triggers DB     : 3 triggers testÃ©s et verts
                    (corrections, lock_members, lock_irreversible)
  Dictionnaire    : 9/9 familles seedÃ©es
                    (test_dict_minimum_coverage.py vert)
  Â§9 Doctrine     : test_incomplete_cba_marked.py vert
                    test_pv_without_locked_committee.py vert
  Verdict         : DONE ou BLOQUÃ‰ â€” jamais "presque"

GATE 2 â€” GO PILOTE TERRAIN
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  PrÃ©requis       : Gate 1 validÃ©
  Milestones requis : + M-SECURITY-CORE + M10-UX-V2
  CI              : ğŸ”´ 24 gates CI bloquants tous verts
  Coverage        : â‰¥ 75%
  RBAC            : 5 rÃ´les testÃ©s (buyer, evaluator,
                    committee, admin, viewer)
  UX              : â‰¥ 1 session test utilisateur terrain rÃ©elle
  Market Survey   : Workflow SR-1 Ã  SR-7 opÃ©rationnel
  Verdict         : DONE ou BLOQUÃ‰

GATE 3 â€” GO PRODUCTION EXTERNE
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  PrÃ©requis       : Gate 2 validÃ©
  Milestones requis : + M-MARKET-SIGNAL-ENGINE
                      + M-ERP-AGNOSTIC-CHECK
                      + M-PILOT-EARLY-ADOPTERS
  CI              : ğŸ”´ test_market_signal_no_impact_on_scores vert
  Market Signal   : 3 sources actives (terrain + historique
                    + mercuriale)
  ERP             : INV-7 vÃ©rifiÃ© (M-ERP-AGNOSTIC-CHECK.done)
  NPS             : â‰¥ 1 early adopter avec feedback terrain
  Verdict         : DONE ou BLOQUÃ‰
```

---

## 5. MÃ©triques de suivi (gelÃ©es)

```
TABLEAU DE BORD â€” Ã€ VÃ‰RIFIER Ã€ CHAQUE FIN DE MILESTONE

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ MÃ©trique                     â”‚ Cible                      â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ CI verte                     â”‚ 100% obligatoire           â”‚
  â”‚ Coverage                     â”‚ Palier phase (0/40/60/75%) â”‚
  â”‚ Gates CI bloquants verts     â”‚ 100% des actifs            â”‚
  â”‚ Triggers PostgreSQL actifs   â”‚ 3/3 (Phase 0-2)            â”‚
  â”‚ Familles dictionnaire        â”‚ 9/9 (Phase 1)              â”‚
  â”‚ Aliases minimum par item     â”‚ â‰¥ 3 (Phase 1)              â”‚
  â”‚ SLA-A mesurÃ©                 â”‚ < 60s (Phase 3)            â”‚
  â”‚ Tests DB-level               â”‚ Verts avant merge          â”‚
  â”‚ PR sur main sans CI rouge    â”‚ 0 tolÃ©rÃ©                   â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 6. Alternatives rejetÃ©es

| Alternative | Raison du rejet |
|-------------|----------------|
| Commencer M-DOCS-CORE sans Phase ZÃ©ro | Repo instable, CI non configurÃ©e, conftest absent â†’ premiers tests impossibles |
| Ã‰crire les triggers en Python (pas en SQL) | Contournable par l'applicatif, INV-6 non garanti au niveau DB |
| Dictionnaire seedÃ© par fixture de test | Non persistant entre sessions, non disponible en production |
| Milestones en parallÃ¨le sur branches sÃ©parÃ©es | DÃ©pendances non respectÃ©es, migrations en conflit |
| Gate coverage unique Ã  40% | Insuffisant pour un standard production (Phases 3+ nÃ©cessitent 75%) |
| Marquer .done avant CI verte | Viole le principe binaire DONE/ABSENT, masque les rÃ©gressions |

---

## 7. ConsÃ©quences

### 7.1 â€” Sur l'exÃ©cution immÃ©diate

```
Toute session de code doit commencer par :

  1. git pull origin main
  2. make milestone-status
  3. Identifier le milestone actif
  4. Lire docs/adrs/ADR-0003.md Â§2.2 (sÃ©quence interne)
  5. ExÃ©cuter dans l'ordre strict
```

### 7.2 â€” Sur les agents IA (Cursor, Claude, Copilot)

```
Tout agent IA reÃ§oit ce prompt systÃ¨me avant toute session :

  "Tu travailles sur DMS V3.3.2.
   Lis obligatoirement avant d'Ã©crire du code :
   - docs/CONSTITUTION_DMS_V3.3.2.md
   - docs/adrs/ADR-0001.md
   - docs/adrs/ADR-0002.md
   - docs/adrs/ADR-0003.md
   Respecte la sÃ©quence Â§2.2 d'ADR-0003.
   Ne dÃ©vie pas. Ne simplifie pas. Ne propose pas d'alternative.
   Milestone actif : [Ã  renseigner]
   Ã‰tape courante  : [Ã  renseigner]"
```

### 7.3 â€” Sur les modifications futures

```
Toute modification du plan d'exÃ©cution (durÃ©es, sÃ©quence,
rÃ¨gles agent, gates) nÃ©cessite :
  - Un nouvel ADR (ADR-0004+)
  - Validation CTO explicite
  - Nouveau tag git + SHA256 dans FREEZE_MANIFEST.md
```

---

## 8. Checklist de freeze

```
CHECKLIST AVANT FREEZE ADR-0003
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

â–¡ ADR-0003.md rÃ©digÃ© intÃ©gralement
â–¡ AlignÃ© avec Constitution V3.3.2 (aucune contradiction)
â–¡ AlignÃ© avec ADR-0001 (fusion M10-UX, M-SECURITY-CORE)
â–¡ AlignÃ© avec ADR-0002 (CI bÃ©tonisation, dict Sahel)
â–¡ SÃ©quence 28 milestones conforme au registre canonique
â–¡ DurÃ©es estimÃ©es rÃ©alistes (non optimistes)
â–¡ RÃ¨gles agent couvertes (interdictions + obligations)
â–¡ Convention nommage branches / migrations / commits gelÃ©e
â–¡ RÃ¨gles spÃ©ciales par milestone critique gelÃ©es
  (M-NORMALISATION-ITEMS, M-SCORING-ENGINE,
   M-COMMITTEE-CORE, M-EXTRACTION-CORRECTIONS)
â–¡ 3 Gates GO/NO-GO avec critÃ¨res binaires
â–¡ Alternatives rejetÃ©es documentÃ©es
â–¡ SHA256 Ã  calculer et inscrire dans FREEZE_MANIFEST.md
â–¡ Tag git : v3.3.2-freeze-patch3
â–¡ Copie immuable dans docs/freeze/v3.3.2/ADR-0003.md
```

---

## 9. DÃ©cision finale

```
Cet ADR-0003 est ACCEPTÃ‰.

Il constitue le document de commandement technique
opposable Ã  tout agent (humain ou IA) avant le premier
commit de code mÃ©tier du DMS V3.3.2.

Il ne remplace pas la Constitution V3.3.2.
Il ne remplace pas ADR-0001 ni ADR-0002.
Il les rend exÃ©cutables de faÃ§on militaire.

Toute dÃ©viation de ce plan est une erreur.
Toute erreur doit Ãªtre corrigÃ©e par ADR numÃ©rotÃ©,
pas par improvisation en cours de session.

FREEZE : Ce document est gelÃ©.
TAG    : v3.3.2-freeze-patch3
SHA256 : Ã€ calculer lors du freeze

Â© 2026 â€” Decision Memory System â€” ADR-0003
```

---

## 10. Prompt systÃ¨me agent (Ã  copier dans chaque session)

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
PROMPT SYSTÃˆME â€” DMS V3.3.2 â€” Ã€ INCLURE DANS TOUTE SESSION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Tu interviens sur le Decision Memory System (DMS) V3.3.2.

DOCUMENTS DE RÃ‰FÃ‰RENCE OBLIGATOIRES (lire avant tout code) :
  docs/CONSTITUTION_DMS_V3.3.2.md
  docs/MILESTONES_EXECUTION_PLAN_V3.3.2.md
  docs/adrs/ADR-0001.md
  docs/adrs/ADR-0002.md
  docs/adrs/ADR-0003.md

MILESTONE ACTIF     : [Ã€ RENSEIGNER PAR LE CTO]
Ã‰TAPE COURANTE      : [Ã€ RENSEIGNER â€” voir ADR-0003 Â§2.2]
DERNIÃˆRE CI         : [verte / rouge]

RÃˆGLES NON NÃ‰GOCIABLES :
  1. SÃ©quence interne Â§2.2 ADR-0003 : Migration â†’ Tests DB
     â†’ Service â†’ Endpoint â†’ Tests API â†’ .done
  2. Jamais d'ORM. RequÃªtes paramÃ©trÃ©es exclusivement.
  3. Jamais d'import Couche B dans Couche A.
  4. Triggers PostgreSQL dans migrations SQL, pas en Python.
  5. CI rouge = stop immÃ©diat. Aucune PR mergÃ©e.
  6. Milestone .done uniquement aprÃ¨s make test vert.

Tu ne proposes pas d'alternative au plan.
Tu ne simplifies pas les rÃ¨gles.
Tu exÃ©cutes l'Ã©tape courante du milestone actif.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

> **ADR-0003 prÃªt pour freeze.**
>
> **Action suivante :**
> 1. Calculer SHA256 de ce fichier
> 2. L'inscrire dans `docs/freeze/v3.3.2/FREEZE_MANIFEST.md`
> 3. CrÃ©er le tag git `v3.3.2-freeze-patch3`
> 4. Copier dans `docs/freeze/v3.3.2/ADR-0003.md`
>
> **Puis : Phase ZÃ©ro. On gÃ©nÃ¨re les fichiers ?**
