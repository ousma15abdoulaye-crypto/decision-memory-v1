<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>DMS ‚Äî MVP A++ FINAL</title>
  <link rel="stylesheet" href="/static/styles.css" />
</head>
<body>
  <div class="container">
    <h1>Decision Memory System ‚Äî MVP A++ (Production)</h1>
    <p class="muted">
      DAO-driven extraction + Template-adaptive CBA/PV + Active Memory.
      <strong>Aucune d√©cision automatique. L'humain d√©cide.</strong>
    </p>

    <section class="card">
      <h2>Constitution & Sant√©</h2>
      <button id="load_const">Afficher Constitution</button>
      <button id="check_health">V√©rifier Sant√© Syst√®me</button>
      <pre id="system_info" class="mono"></pre>
    </section>

    <section class="card">
      <h2>1) Cr√©er un nouveau cas</h2>
      <div class="row">
        <label>Type</label>
        <select id="case_type">
          <option value="DAO">DAO</option>
          <option value="RFQ">RFQ</option>
        </select>
      </div>
      <div class="row">
        <label>Titre</label>
        <input id="case_title" placeholder="Ex: DAO MOPTI-2026-01 ‚Äî Cartouches imprimantes" />
      </div>
      <div class="row">
        <label>Lot (optionnel)</label>
        <input id="case_lot" placeholder="Ex: Lot 1" />
      </div>
      <button id="create_case">Cr√©er le cas</button>
    </section>

    <section class="card">
      <h2>2) S√©lectionner un cas</h2>
      <button id="refresh_cases">Rafra√Æchir la liste</button>
      <div id="cases"></div>
    </section>

    <section class="card">
      <h2>3) Uploader les documents</h2>
      <p class="muted">
        <strong>Important:</strong> Chaque cas a son propre template CBA/PV.
        Upload le template SP√âCIFIQUE √† ce DAO (ex: CBA-CARTOUCHES.xlsx pour cartouches).
      </p>

      <div class="grid2">
        <div>
          <h3>üìÑ DAO (docx/pdf)</h3>
          <input type="file" id="dao_file" accept=".pdf,.docx" />
          <button data-kind="dao" class="upload_btn">Upload DAO</button>
        </div>

        <div>
          <h3>üì¶ OFFRES (docx/pdf, multiples)</h3>
          <input type="file" id="offer_files" multiple accept=".pdf,.docx" />
          <button data-kind="offer" class="upload_btn">Upload OFFRES</button>
        </div>

        <div>
          <h3>üìä Template CBA (xlsx) ‚Äî SP√âCIFIQUE au DAO</h3>
          <input type="file" id="cba_file" accept=".xlsx" />
          <button data-kind="cba_template" class="upload_btn">Upload CBA Template</button>
        </div>

        <div>
          <h3>üìù Template PV (docx) ‚Äî SP√âCIFIQUE au DAO</h3>
          <input type="file" id="pv_file" accept=".docx" />
          <button data-kind="pv_template" class="upload_btn">Upload PV Template</button>
        </div>
      </div>
    </section>

    <section class="card">
      <h2>4) Lancer l'analyse (DAO-driven)</h2>
      <button id="analyze">üöÄ Analyser et G√©n√©rer CBA + PV</button>
      <pre id="analyze_result" class="mono"></pre>
      <div id="warnings" class="warnings"></div>
      <div id="downloads"></div>
    </section>

    <section class="card">
      <h2>5) D√©cision humaine (finale)</h2>
      <p class="muted">
        Le syst√®me ne recommande AUCUN fournisseur. La d√©cision est 100% humaine.
      </p>
      <div class="row">
        <label>Fournisseur choisi</label>
        <input id="chosen_supplier" placeholder="Ex: COMPUTECH SARL" />
      </div>
      <div class="row">
        <label>Justification</label>
        <textarea id="decision_reason" placeholder="Raison du choix (prix, d√©lai, capacit√©, etc.)"></textarea>
      </div>
      <div class="row">
        <label>Action suivante</label>
        <input id="next_action" placeholder="Ex: Bon de commande √©mis" />
      </div>
      <button id="decide">‚úÖ Enregistrer d√©cision + R√©g√©n√©rer PV final</button>
      <pre id="decide_result" class="mono"></pre>
    </section>

    <section class="card">
      <h2>6) M√©moire active (recherche)</h2>
      <div class="row">
        <label>Rechercher</label>
        <input id="mem_q" placeholder="Ex: prix, d√©lai, IMAF, conformit√©..." />
      </div>
      <button id="search_mem">üîç Chercher dans la m√©moire</button>
      <pre id="mem_hits" class="mono"></pre>
    </section>

    <p class="footer muted">
      Version 1.0.0 ‚Äî DAO-driven + Template-adaptive + Active Memory.<br>
      OCR pour scans/photos WhatsApp arrive en V1.2.
    </p>
  </div>

  <script src="/static/app.js"></script>
</body>
</html>
