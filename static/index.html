<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>DMS ‚Äî MVP A++ FINAL</title>
  <link rel="stylesheet" href="/static/styles.css" />
</head>
<body>
  <a href="#main-content" class="skip-link">Aller au contenu principal</a>
  <div class="container" id="main-content" role="main">
    <h1>Decision Memory System ‚Äî MVP A++ (Production)</h1>
    <p class="muted">
      DAO-driven extraction + Template-adaptive CBA/PV + Active Memory.
      <strong>Aucune d√©cision automatique. L'humain d√©cide.</strong>
    </p>

    <section class="card">
      <h2>Constitution & Sant√©</h2>
      <button id="load_const" aria-label="Afficher la Constitution du syst√®me">Afficher Constitution</button>
      <button id="check_health" aria-label="V√©rifier la sant√© du syst√®me">V√©rifier Sant√© Syst√®me</button>
      <pre id="system_info" class="mono" role="status" aria-live="polite" aria-atomic="true"></pre>
    </section>

    <section class="card">
      <h2>1) Cr√©er un nouveau cas</h2>
      <div class="row">
        <label for="case_type">Type</label>
        <select id="case_type" aria-label="Type de cas">
          <option value="DAO">DAO</option>
          <option value="RFQ">RFQ</option>
        </select>
      </div>
      <div class="row">
        <label for="case_title">Titre</label>
        <input id="case_title" placeholder="Ex: DAO MOPTI-2026-01 ‚Äî Cartouches imprimantes" aria-label="Titre du cas" />
      </div>
      <div class="row">
        <label for="case_lot">Lot (optionnel)</label>
        <input id="case_lot" placeholder="Ex: Lot 1" aria-label="Lot optionnel" />
      </div>
      <button id="create_case" aria-label="Cr√©er le cas">Cr√©er le cas</button>
    </section>

    <section class="card">
      <h2>2) S√©lectionner un cas</h2>
      <button id="refresh_cases" aria-label="Rafra√Æchir la liste des cas">Rafra√Æchir la liste</button>
      <div id="cases" role="list" aria-label="Liste des cas"></div>
    </section>

    <section class="card">
      <h2>3) Uploader les documents</h2>
      <p class="muted">
        <strong>Important:</strong> Chaque cas a son propre template CBA/PV.
        Upload le template SP√âCIFIQUE √† ce DAO (ex: CBA-CARTOUCHES.xlsx pour cartouches).
      </p>

      <div class="grid2">
        <div>
          <h3><span aria-hidden="true">üìÑ</span> DAO (docx/pdf)</h3>
          <label for="dao_file" class="sr-only">Fichier DAO (docx ou pdf)</label>
          <input type="file" id="dao_file" accept=".pdf,.docx" aria-label="S√©lectionner fichier DAO docx ou pdf" />
          <button data-kind="dao" class="upload_btn" aria-label="Upload du fichier DAO">Upload DAO</button>
        </div>

        <div>
          <h3><span aria-hidden="true">üì¶</span> OFFRES (docx/pdf, multiples)</h3>
          <label for="offer_files" class="sr-only">Fichiers offres (docx ou pdf, multiples)</label>
          <input type="file" id="offer_files" multiple accept=".pdf,.docx" aria-label="S√©lectionner fichiers offres docx ou pdf" />
          <button data-kind="offer" class="upload_btn" aria-label="Upload des fichiers offres">Upload OFFRES</button>
        </div>

        <div>
          <h3><span aria-hidden="true">üìä</span> Template CBA (xlsx) ‚Äî SP√âCIFIQUE au DAO</h3>
          <label for="cba_file" class="sr-only">Template CBA (xlsx)</label>
          <input type="file" id="cba_file" accept=".xlsx" aria-label="S√©lectionner template CBA xlsx" />
          <button data-kind="cba_template" class="upload_btn" aria-label="Upload du template CBA">Upload CBA Template</button>
        </div>

        <div>
          <h3><span aria-hidden="true">üìù</span> Template PV (docx) ‚Äî SP√âCIFIQUE au DAO</h3>
          <label for="pv_file" class="sr-only">Template PV (docx)</label>
          <input type="file" id="pv_file" accept=".docx" aria-label="S√©lectionner template PV docx" />
          <button data-kind="pv_template" class="upload_btn" aria-label="Upload du template PV">Upload PV Template</button>
        </div>
      </div>
    </section>

    <section class="card">
      <h2>4) Lancer l'analyse (DAO-driven)</h2>
      <button id="analyze" aria-label="Analyser et g√©n√©rer CBA et PV"><span aria-hidden="true">üöÄ</span> Analyser et G√©n√©rer CBA + PV</button>
      <pre id="analyze_result" class="mono" role="status" aria-live="polite" aria-atomic="true"></pre>
      <div id="warnings" class="warnings" role="alert" aria-live="assertive" aria-atomic="true"></div>
      <div id="downloads" role="region" aria-label="T√©l√©chargements disponibles" aria-live="polite" aria-atomic="true"></div>
    </section>

    <section class="card">
      <h2>5) D√©cision humaine (finale)</h2>
      <p class="muted">
        Le syst√®me ne recommande AUCUN fournisseur. La d√©cision est 100% humaine.
      </p>
      <div class="row">
        <label for="chosen_supplier">Fournisseur choisi</label>
        <input id="chosen_supplier" placeholder="Ex: COMPUTECH SARL" aria-label="Fournisseur choisi" />
      </div>
      <div class="row">
        <label for="decision_reason">Justification</label>
        <textarea id="decision_reason" placeholder="Raison du choix (prix, d√©lai, capacit√©, etc.)" aria-label="Justification de la d√©cision"></textarea>
      </div>
      <div class="row">
        <label for="next_action">Action suivante</label>
        <input id="next_action" placeholder="Ex: Bon de commande √©mis" aria-label="Action suivante" />
      </div>
      <button id="decide" aria-label="Enregistrer la d√©cision et r√©g√©n√©rer le PV final"><span aria-hidden="true">‚úÖ</span> Enregistrer d√©cision + R√©g√©n√©rer PV final</button>
      <pre id="decide_result" class="mono" role="status" aria-live="polite" aria-atomic="true"></pre>
    </section>

    <section class="card">
      <h2>6) M√©moire active (recherche)</h2>
      <div class="row">
        <label for="mem_q">Rechercher</label>
        <input id="mem_q" placeholder="Ex: prix, d√©lai, IMAF, conformit√©..." aria-label="Recherche dans la m√©moire" />
      </div>
      <button id="search_mem" aria-label="Chercher dans la m√©moire"><span aria-hidden="true">üîç</span> Chercher dans la m√©moire</button>
      <pre id="mem_hits" class="mono" role="status" aria-live="polite" aria-atomic="true"></pre>
    </section>

    <p class="footer muted">
      Version 1.0.0 ‚Äî DAO-driven + Template-adaptive + Active Memory.<br>
      OCR pour scans/photos WhatsApp arrive en V1.2.
    </p>
  </div>

  <script src="/static/app.js"></script>
</body>
</html>
